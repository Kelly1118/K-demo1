西安优盛信息技术有限公司–-人才服务认证培训企业运维
地址：西安市太白南路139号云图中心1811室 电话：029-87301012 网址：www.udbs.cn
SQL基础练习题
1)下面的SELECT语句是否执行成功：SELECTlast_name,job_id,salaryASSal
FROM
employees;
1)SELECT语句应该执行成功。它选择了EMPLOYEES表中的last_name,job_id和salary列，并将
salary列的别名设置为Sal。
2)在下面的语句中有4个编码错误，请找出它们：SELECTemployee_id,last_namesalx12
ANNUALSALARYFROMemployees;
2)下面是修正后的语句，已经修复了所有的编码错误：SELECTemployee_id,last_name,'ANNUAL
SALARY'ASsalx12FROMemployees;
3)显示DEPARTMENTS表的结构。选择表中的所有数据。
3)显示DEPARTMENTS表的结构：DESCRIBEDEPARTMENTS;
4)显示EMPLOYEES表的结构。创建一个查询，显示每个雇员的lastname,job_id,
hire_date,employee_id.employee_id显示在第一列，给HIRE_DATE列指定一个别
名STARTDATE。
4)显示EMPLOYEES表的结构，并创建一个查询来显示每个雇员的lastname,job_id,hire_date和
employee_id。同时，将hire_date列的别名设置为STARTDATE，将employee_id列放在第一列：
DESCRIBEEMPLOYEES;SELECTemployee_id,last_name,job_id,hire_dateASSTARTDATEFROM
5)创建一个查询从EMPLOYEES表中显示全体在编员工的唯一职务信息。
5)创建一个查询，显示EMPLOYEES表中所有在编员工的唯一职务信息：SELECTDISTINCTjob_idFROM
6)创建一个查询，显示收入超过$12,000的雇员的名字和薪水。
6)创建一个查询，显示收入超过$12,000的雇员的名字和薪水：
SELECTlast_name,salary
FROMemployees
WHEREsalary>12000;西安优盛信息技术有限公司–-人才服务认证培训企业运维
7)将6)的SQL语句存到文件lab2_1.sql中，运行该脚本执行查询。
8)创建一个查询，显示雇员号为176的雇员的姓名和所在部门的编号。
8)创建一个查询，显示雇员号为176的雇员的姓名和所在部门的编号：
SELECTe.last_name,d.department_id
FROMemployeese
JOINdepartmentsdONe.department_id=d.department_id
WHEREe.employee_id=176;
9)修改lab2_1.sql文件，显示所有薪水不在$5000和$12000之间的雇员的名字和薪水。
将修改后的SQL语句存到文件lab2_3.sql中。
9)修改lab2_1.sql文件，显示所有薪水不在$5000和$12000之间的雇员的名字和薪水。将修改后
的SQL语句存到文件lab2_3.sql中。
WHEREsalaryNOTBETWEEN5000AND12000;
10)显示受雇日期在1998年2月20日和1998年5月1日之间的雇员的名字、岗位和受雇日期，按受
雇日期降序排序查询结果。
10)显示受雇日期在1998年2月20日和1998年5月1日之间的雇员的名字、岗位和受雇日期
，按受雇日期降序排序查询结果：
SELECTlast_name,job_id,hire_date
WHEREhire_dateBETWEEN'1998-02-20'AND'1998-05-01'
ORDERBYhire_dateDESC;
11)显示所有在部门20和50中的雇员的名字和部门号，并以名字按字母升序排序。
11)创建一个查询，显示所有在部门20和50中的雇员的名字和部门号，并以名字按字母升序排序：
SELECTlast_name,department_id
WHEREdepartment_idIN(20,50)
ORDERBYlast_nameASC;西安优盛信息技术有限公司–-人才服务认证培训企业运维
12)修改lab2_3.sql列出收入在$5,000和$12,000之间，并且在部门20或50工作的雇
员的名字和薪水。将列标题分别显示为Employee和MonthlySalary，将SQL保
lab2_6.sql。
12)修改lab2_3.sql，列出收入在$5,000和$12,000之间，并且在部门20或50工作的雇员的名
字和薪水。将列标题分别显示为Employee和MonthlySalary，将SQL保存到lab2_6.sql：
SELECTlast_nameASEmployee,salaryAS"MonthlySalary"
WHEREsalaryBETWEEN5000AND12000
ANDdepartment_idIN(20,50);
13)显示每一个在1994年入职的雇员的名字和入职日期。
13)显示每一个在1994年入职的雇员的名字和入职日期：
SELECTlast_name,hire_date
WHEREhire_dateBETWEEN'1994-01-01'AND'1994-12-31';
14）显示所有没有主管经理的雇员的名字和工作岗位。
14)显示所有没有主管经理的雇员的名字和工作岗位：
SELECTlast_name,job_id
WHEREmanager_idISNULL;
15)显示所有有佣金的雇员的名字、薪水和佣金，以薪水和佣金的降序排序数据。
15)显示所有有佣金的雇员的名字、薪水和佣金，以薪水和佣金的降序排序数据：
SELECTlast_name,salary,commission_pct
WHEREcommission_pctISNOTNULL
ORDERBYsalaryDESC,commission_pctDESC西安优盛信息技术有限公司–-人才服务认证培训企业运维
16)显示所有名字中第三个字母是a的雇员的名字。
16)显示所有名字中第三个字母是a的雇员的名字：
SELECTlast_name
WHERElast_nameLIKE'__a%';
17)显示所有名字中有一个a和一个e的雇员的名字
17)显示所有名字中有一个a和一个e的雇员的名字：
WHERElast_nameLIKE'%a%e%';
18)显示所有工作是销售代表或者普通职员，并且薪水不等于$2,500、$3,500或$7,000的雇员的名
字、工作和薪水。
字、工作和薪水：
SELECTlast_name,job_id,salary
WHERE(job_id='SA_REP'ORjob_id='ST_CLERK')
ANDsalaryNOTIN(2500,3500,7000);
19)写一个查询显示当前日期，列标签显示为DATE。
19)写一个查询显示当前日期，列标签显示为DATE：
SELECTCURRENT_DATEAS"DATE";
20)对每一个雇员，显示employee_id,last_name,salary,salary增加15%，并且表示成整数，列标
签显示为NewSalary,将SQL语句存到名为lab3_2.sql的文本文件中。
20)对每一个雇员，显示employee_id,last_name,salary,salary增加15%，并且表示成整数，列
标签显示为NewSalary，将SQL语句存到名为lab3_2.sql的文本文件中：
SELECTemployee_id,last_name,salary,ROUND(salary*1.15)AS"NewSalary"
FROMemployees;西安优盛信息技术有限公司–-人才服务认证培训企业运维
21)修改查询lab3_2.sql添加一个列，该列从新薪水NewSalary列中减去旧薪水，列标签为
increase,SQL保存内容到文件lab3_4.sql中，运行修订的查询。
21)修改查询lab3_2.sql，添加一个列，该列为新薪水NewSalary减去旧薪水，列标签为increase，
将SQL保存到文件lab3_4.sql，并运行修订的查询。
SELECTemployee_id,last_name,salary,ROUND(salary*1.15)AS"NewSalary",
ROUND((salary*1.15)-salary)ASincrease
FROMemployees;
22)写一个查询用首写字母大写，其它字母小写显示雇员的last_name,并显示姓名的长度，对
所有姓名开始字母是J、A或M的雇员，给每列一个适当的标签，用last_name对结果排序。
22)写一个查询，将雇员的last_name以首字母大写、其余字母小写的形式显示，并显示姓名的长度
。查询结果仅包括以J、A或M开头的雇员的last_name，并对结果按照last_name进行排序。
SELECTUPPER(SUBSTRING(last_name,1,1))+LOWER(SUBSTRING(last_name,2))AS"LastName",
LENGTH(last_name)AS"NameLength"
WHERElast_nameLIKE'J%'ORlast_nameLIKE'A%'ORlast_nameLIKE'M%'
ORDERBYlast_name;
23)对每一个雇员，显示其last_name,并计算从雇员受雇日期到今天的月数，列标签为MONTHS
__WORKED，按受雇月数排序结果，四舍五入月数到最靠近的整数月。
23)对于每个雇员，显示其last_name，并计算从雇员受雇日期到今天的月数，列标签为
MONTHS_WORKED。按照受雇月数对结果进行排序，四舍五入月数到最接近的整数月。
SELECTlast_name,ROUND(DATEDIFF(CURRENT_DATE,hire_date)/30)AS"MONTHS_WORKED"
ORDERBYMONTHS_WORKED;
24)创建一个查询显示所有雇员的last_name和salary.salary格式化为15个字符长度，用
$左填充，列标签为SALARY。
24)创建一个查询，显示所有雇员的last_name和salary。将salary格式化为15个字符长度，用
$左对齐填充，列标签为SALARY。
SELECTlast_name,LPAD(CONCAT('$',salary),15,'$')AS"SALARY"
25）显示每一个雇员的last_name,hire_date和雇员入职周内天数，列标签DAY，用星期一作为每
周的起始日。
25)显示每个雇员的last_name、hire_date和雇员入职周内的天数，列标签为DAY，以星期一作为每
SELECTlast_name,hire_date,(DAYOFWEEK(hire_date)+5)%7+1AS"DAY"
26)创建一个查询显示雇员的last_names和commission(佣金)比率。如果雇员没有佣金显示
“NoCommission”，列标签为COMM。
26)创建一个查询，显示雇员的last_name和commission比率。如果雇员没有佣金，显示"No
Commission"，列标签为COMM。
SELECTlast_name,
CASE
WHENcommission_pctISNULLTHEN'NoCommission'
ELSECONCAT(commission_pct*100,'%')
ENDAS"COMM"
27)显示所有雇员的最高、最低、合计和平均薪水，列标签分别为：maximum、minmum、sum、
average。四舍五入结果为最近的整数。
27)显示所有雇员的最高、最低、合计和平均薪水，列标签分别为：maximum、minimum、sum、average
。四舍五入结果为最近的整数。
SELECTMAX(salary)AS"maximum",
MIN(salary)AS"minimum",
SUM(salary)AS"sum",
ROUND(AVG(salary))AS"average"
28)对27)的问题显示每种工作类型的最低、最高、合计、平均薪水。
28)对于问题27)，显示每种工作类型的最低、最高、合计、平均薪水。
SELECTjob_id,
MAX(salary)AS"maximum",
GROUPBYjob_id;
29)显示每一个工作岗位的人数。
29)显示每个工作岗位的人数。
SELECTjob_id,COUNT(*)AS"NumberofEmployees"
30)显示所有经理人数。
30)显示所有经理的人数。
SELECTCOUNT(*)AS"NumberofManagers"
WHEREjob_id='IT_PROG'ORjob_id='ST_MAN';
31)显示最高与最低薪水之间的差额。
SELECTMAX(salary)-MIN(salary)AS"SalaryDifference"
32)显示每个部门的名字、地点、人数和部门中所有雇员的平均薪水。四舍五入薪水到两位小数。
SELECTd.department_name,d.location_id,COUNT(e.employee_id)AS"NumberofEmployees",
ROUND(AVG(e.salary),2)AS"AverageSalary"
FROMdepartmentsd
JOINemployeeseONd.department_id=e.department_id
GROUPBYd.department_name,d.location_id;
33)写一个查询显示所有雇员的last_name,department_idanddepartment_name。
33)写一个查询显示所有雇员的last_name,department_id和department_name。
SELECTe.last_name,e.department_id,d.department_name
JOINdepartmentsdONe.department_id=d.department_id;
34)创建一个在部门80中的所有工作岗位的唯一列表，在输出中包括部门的地点。
SELECTDISTINCTjob_id,location_id
WHEREdepartment_id=80;
35)显示所有在其last_name中有一个小写a的雇员的last_name和department_name。
SELECTlast_name,department_name
JOINdepartmentsONemployees.department_id=departments.department_id
WHERElast_nameLIKE'%a%';西安优盛信息技术有限公司–-人才服务认证培训企业运维
36)写一个查询显示那些工作在Toronto的所有雇员的last_name、job_id、department_id和
department_name。
SELECTe.last_name,e.job_id,e.department_id,d.department_name
WHEREd.location_id='Toronto';
37)显示雇员的last_name和employee_id连同他们的经理的last_name和manager_id，列标签为
employee、emp_id、manager和mgr_id。
SELECTe.last_nameAS"employee",e.employee_idAS"emp_id",m.last_nameAS"manager",
e.manager_idAS"mgr_id"
JOINemployeesmONe.manager_id=m.employee_id;
38)创建一个查询，显示所有与被指定雇员工作在同一部门的雇员的last_names、
department_id。给每列一个适当的标签。
38)创建一个查询，显示所有与被指定雇员工作在同一部门的雇员的last_names、department_id。给
每列一个适当的标签。
SELECTe.last_nameAS"last_names",e.department_id
JOINemployeesmONe.department_id=m.department_id
WHEREm.last_name='指定雇员的last_name';西安优盛信息技术有限公司–-人才服务认证培训企业运维
39)写一个查询显示与zlotkey在同一部门的雇员的lastname和hiredate,结果中不包括zlotkey。
39)写一个查询显示与zlotkey在同一部门的雇员的lastname和hiredate，结果中不包括
zlotkey。
WHEREdepartment_id=(SELECTdepartment_idFROMemployeesWHERElast_name='zlotkey')
ANDlast_name!='zlotkey';
40)创建一个查询显示所有薪水高于平均薪水的雇员的雇员编号和名字，按薪水的升序排序。
SELECTemployee_id,last_name
WHEREsalary>(SELECTAVG(salary)FROMemployees)
ORDERBYsalaryASC;
41)显示所有部门位置编号（location_id）是1700的雇员的lastname、departtment_id和
job_id。
41)显示所有部门位置编号（location_id）是1700的雇员的lastname、department_id和job_id
。
SELECTlast_name,department_id,job_id
WHEREdepartment_idIN(SELECTdepartment_idFROMdepartmentsWHERElocation_id=1700);
42)显示在Executive部门的每个雇员的department_id、last_name和job_id。
SELECTdepartment_id,last_name,job_id
WHEREdepartment_id=(SELECTdepartment_idFROMdepartmentsWHEREdepartment_name=
'Executive');
THEEND
